

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-touch-icon.png">
  <link rel="icon" href="/img/favicon/favicon-32x32.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="ZhangHao">
  <meta name="keywords" content="合约广告,在线分配问题,在线投放引擎,频次控制,分层实验框架,用户画像,受众定向,上下文定向">
  
    <meta name="description" content="这是刘鹏老师计算广告课程的笔记，这部分主要讲解合约广告的相关内容，包括合约广告的历史，技术挑战以及定向中使用的受众定向和上下文定向。">
<meta property="og:type" content="article">
<meta property="og:title" content="计算广告|4.合约广告">
<meta property="og:url" content="https://imzhanghao.com/2020/06/15/computing-advertising-4-agreement-based-advertising/index.html">
<meta property="og:site_name" content="张浩在路上">
<meta property="og:description" content="这是刘鹏老师计算广告课程的笔记，这部分主要讲解合约广告的相关内容，包括合约广告的历史，技术挑战以及定向中使用的受众定向和上下文定向。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-06-14T16:00:00.000Z">
<meta property="article:modified_time" content="2022-01-16T14:27:03.865Z">
<meta property="article:author" content="ZhangHao">
<meta property="article:tag" content="计算广告">
<meta property="article:tag" content="合约广告">
<meta name="twitter:card" content="summary_large_image">
  
  
  <title>计算广告|4.合约广告 - 张浩在路上</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"imzhanghao.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"0c64a5657309290fd8f5efe33fcbcdb4","google":"UA-166608124-1","gtag":"G-PKN25ZF7R2","tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="张浩在路上" type="application/atom+xml">
</head>


<body>
  <header style="height: 45vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>张浩在路上</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-books"></i>
                系列
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/technology/">
                    <i class="iconfont icon-bug"></i>
                    技术
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/monetization/">
                    <i class="iconfont icon-briefcase"></i>
                    变现
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/thinking/">
                    <i class="iconfont icon-books"></i>
                    思考
                  </a>
                
              </div>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="计算广告|4.合约广告">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-06-15 00:00" pubdate>
        2020年6月15日 凌晨
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.4k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      46 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">计算广告|4.合约广告</h1>
            
            <div class="markdown-body">
              <h2 id="广告位和展示量合约"><a class="markdownIt-Anchor" href="#广告位和展示量合约"></a> 广告位和展示量合约</h2>
<h3 id="广告位cpt合约"><a class="markdownIt-Anchor" href="#广告位cpt合约"></a> 广告位（CPT）合约</h3>
<p>与线下广告交易类似的传统模式</p>
<p>供给方产品：产品排期系统</p>
<ul>
<li>帮助媒体自动执行多个合同的排期</li>
<li>广告没有复杂的动态决策，因此可以将素材直接插入页面</li>
</ul>
<p>流量选择的维度</p>
<ul>
<li>时间段、地域、轮播</li>
</ul>
<p>典型场景</p>
<ul>
<li>高曝光广告位，开屏广告，应用市场头部位置，导航网址</li>
</ul>
<h3 id="展示量合约与担保式投送"><a class="markdownIt-Anchor" href="#展示量合约与担保式投送"></a> 展示量合约与担保式投送</h3>
<p>展示量合约</p>
<ul>
<li>基于合约的广告机制，有时未完成约定量要向广告商补偿</li>
<li>多采用千次展示付费（Cost per Mille，CPM）方式结算</li>
</ul>
<p>担保式投送（Guaranteed Delivery，GD）引擎</p>
<ul>
<li>CPM方式要求广告投送由服务器端完成决策</li>
<li>三大技术基础：受众定向、流量预测、在线分配</li>
</ul>
<p>典型场景</p>
<ul>
<li>视频广告、富媒体广告、品牌横幅广告</li>
</ul>
<h3 id="广告位合约-vs-展示量合约"><a class="markdownIt-Anchor" href="#广告位合约-vs-展示量合约"></a> 广告位合约 vs 展示量合约</h3>
<p>广告位合约</p>
<ul>
<li>开辟了多个广告位</li>
<li>分时段卖给不同的广告主。</li>
</ul>
<p>展示量合约</p>
<ul>
<li>仅需要开辟较少的广告位</li>
<li>将用户流量卖给不同的广告主</li>
</ul>
<p>展示量合约更先进，前提是需要支持受众定向</p>
<h3 id="s1如何高效混合静态与动态广告"><a class="markdownIt-Anchor" href="#s1如何高效混合静态与动态广告"></a> S1.如何高效混合静态与动态广告？</h3>
<p>前端代码先去CDN上取一个默认广告，然后再去请求广告服务器。</p>
<ul>
<li>前段代码先去CDN上获取默认广告。</li>
<li>判断是否CPT广告，如果是，<strong>展示CDN广告</strong>，如果不是，请求广告服务器。</li>
<li>判断广告服务器是否成功返回，如果是，<strong>展示服务器返回的广告</strong>；如果不是，<strong>展示CDN默认广告</strong>。</li>
</ul>
<blockquote>
<p>思考：什么样的人群适合于在CPM广告中售卖？</p>
</blockquote>
<span id="more"></span>
<h2 id="多个合约如何满足在线分配问题"><a class="markdownIt-Anchor" href="#多个合约如何满足在线分配问题"></a> 多个合约如何满足：在线分配问题</h2>
<h3 id="a4展示量合约流量分配模型"><a class="markdownIt-Anchor" href="#a4展示量合约流量分配模型"></a> A4.展示量合约流量分配模型</h3>
<h3 id="流量预测统计"><a class="markdownIt-Anchor" href="#流量预测统计"></a> 流量预测–统计</h3>
<p>可视为query为a，对流量进行检索的反向查询问题。</p>
<p>预测过程</p>
<ul>
<li>给定a，首先通过u的索引找到所有符合条件的c的集合</li>
<li>对每个u估计r(a，u)，并根据<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>P</mi><mi>u</mi></msub><mo stretchy="false">(</mo><mi>e</mi><mi>C</mi><mi>P</mi><mi>M</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_u(eCPM)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.10903em;">M</span><span class="mclose">)</span></span></span></span>得到a在u上胜出的百分比<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(a,u)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span></span></span></span>，并将a的流量累加<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>u</mi><mo stretchy="false">)</mo><mo>∗</mo><mi>I</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>N</mi><mi>u</mi><msub><mi>m</mi><mi>u</mi></msub></mrow><annotation encoding="application/x-tex">p(a,u)*ImpressionNum_u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">u</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">u</span><span class="mord"><span class="mord mathdefault">m</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">u</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<h3 id="a4在线分配问题框架"><a class="markdownIt-Anchor" href="#a4在线分配问题框架"></a> A4.在线分配问题框架</h3>
<ul>
<li>r是收益，q是惩罚</li>
<li>惩罚和奖励是一回事</li>
</ul>
<h3 id="a4在线分配典型问题"><a class="markdownIt-Anchor" href="#a4在线分配典型问题"></a> A4.在线分配典型问题</h3>
<p>Adwords～考虑预算，没有提升。</p>
<p>预算在竞价广告中是一个软约束，投完广告主会继续投。</p>
<h3 id="a4基于归偶算法的紧凑分配方案"><a class="markdownIt-Anchor" href="#a4基于归偶算法的紧凑分配方案"></a> A4.基于归偶算法的紧凑分配方案</h3>
<p>紧凑分配方案(Compact Allocation plan)</p>
<ul>
<li>变量数正比于|A|，而非|E|或|I|</li>
<li>分配策略最好的是无状态的，这样可以避免服务器之间的同步</li>
</ul>
<p>由<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.0037em;">α</span></span></span></span>恢复<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>β</mi></mrow><annotation encoding="application/x-tex">\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05278em;">β</span></span></span></span>和分配变量x：公式略</p>
<p>由历史数据求解上述问题规模太大，需要对数据做一些采样以便更高效地得到分配方案。</p>
<h3 id="a4启发式的high-water-mark算法"><a class="markdownIt-Anchor" href="#a4启发式的high-water-mark算法"></a> A4.启发式的High Water Mark算法</h3>
<p>离线规划</p>
<ul>
<li>令每个供给节点i的剩余supply等于预留量<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>←</mo><msub><mi>s</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i\leftarrow s_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>将每个a按照<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma(a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>中所有供给流量做升序排列，确定分配优先级</li>
<li>按照分配优先级对每个a解下式的到其投放率 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>β</mi><mi>α</mi></msub><mo>:</mo><msub><mo>∑</mo><mrow><mi>i</mi><mo>∈</mo><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow></msub><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">{</mo><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><msub><mi>β</mi><mi>α</mi></msub><mo fence="true">}</mo></mrow><mo>=</mo><msub><mi>d</mi><mi>a</mi></msub></mrow><annotation encoding="application/x-tex">\beta _{\alpha } : \sum_{i\in \Gamma (a)}min  \left \{r_i,s_i\beta _\alpha  \right \}=d_a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">α</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">:</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.22471em;vertical-align:-0.47471em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.22528999999999993em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">∈</span><span class="mord mtight">Γ</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">a</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.47471em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">a</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
<li>对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Γ</mi><mo stretchy="false">(</mo><mi>a</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Gamma (a)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">Γ</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mclose">)</span></span></span></span>中的每个i，令<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub><mo>←</mo><msub><mi>r</mi><mi>i</mi></msub><mo>−</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo fence="true">{</mo><msub><mi>r</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>i</mi></msub><msub><mi>β</mi><mi>α</mi></msub><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">r_i\leftarrow r_i - min \left \{r_i,s_i\beta _\alpha  \right \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05278em;">β</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.05278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.0037em;">α</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span></li>
</ul>
<p>在线分配</p>
<ul>
<li>对某次展示，{a1,……,aj}为按照分配优先级排序的所有满足要求的广告</li>
<li>将上面的广告按照投放率随机分配其展示机会</li>
</ul>
<h3 id="yahoo展示广告市场"><a class="markdownIt-Anchor" href="#yahoo展示广告市场"></a> yahoo！展示广告市场</h3>
<p>核心业务</p>
<ul>
<li>GD，无法分配的流量转接到NGD（non-guaranteed delivery，即Rightmedia exchange）进行变现</li>
<li>GD市场广告主数量为几千，年收入为Billion量级。</li>
</ul>
<p>其他点评</p>
<ul>
<li>采用compact allocation plan 完成线上决策</li>
<li>提供地域、人口属性、行为定向（常用的仅有几十个标签）</li>
<li>合约式销售中，品牌广告主对曝光有独占要求</li>
</ul>
<h2 id="高并发的广告系统在线投放引擎"><a class="markdownIt-Anchor" href="#高并发的广告系统在线投放引擎"></a> 高并发的广告系统：在线投放引擎</h2>
<h3 id="s2在线投放引擎"><a class="markdownIt-Anchor" href="#s2在线投放引擎"></a> S2.在线投放引擎</h3>
<h3 id="s2nginx"><a class="markdownIt-Anchor" href="#s2nginx"></a> S2.Nginx</h3>
<p>轻量级Web服务器/反向代理服务器</p>
<ul>
<li>专为性能优化二开发，可支持数万并发</li>
<li>内存和CPU占用较少</li>
</ul>
<p>Nginx + FastCGI</p>
<ul>
<li>将主要业务逻辑在FastCGI中用C语言实现</li>
</ul>
<p>其他产品选择:Apache</p>
<h3 id="s2zookeeper-by-yahoo"><a class="markdownIt-Anchor" href="#s2zookeeper-by-yahoo"></a> S2.Zookeeper by Yahoo!</h3>
<p>解决分布式应用中的一些数据管理问题</p>
<ul>
<li>集群管理、分布式应用配置项的管理等</li>
<li>理论基础是著名的Paxos算法</li>
</ul>
<p>集群管理</p>
<ul>
<li>将宕机、网络断链、新机器加入等迅速通知每台Server并重新分配流量</li>
<li>用Zookeeper的Watch机制很容易实现</li>
</ul>
<h3 id="s2频次控制"><a class="markdownIt-Anchor" href="#s2频次控制"></a> S2.频次控制</h3>
<p>问题定义</p>
<ul>
<li>限制各（a,u）组合在一定时间周期内的展示量</li>
</ul>
<p>问题特性</p>
<ul>
<li>频次存储的规模是有上界的。（a,u）组合总数不会超过时间周期内的展示总数。</li>
<li>生成用（a,u）对应的key时，不需要处理冲突，因此不需要哈希结构。</li>
<li>专用的、轻量级的内存表比大多数No-SQL存储方案更加实用。</li>
</ul>
<h3 id="s2实验框架experimentation-framework"><a class="markdownIt-Anchor" href="#s2实验框架experimentation-framework"></a> S2.实验框架（Experimentation Framework）</h3>
<p>那些场景需要线上A/B测试？</p>
<ul>
<li>广告系统的升级</li>
<li>广告算法的改进</li>
<li>创意或定向策略的优化</li>
</ul>
<p>实验框架的设计原则</p>
<ul>
<li>任何一组对比实验，其他的条件应该相同</li>
<li>线上流量容纳尽可能多的实验</li>
</ul>
<h3 id="s2分层实验框架"><a class="markdownIt-Anchor" href="#s2分层实验框架"></a> S2.分层实验框架</h3>
<p>发布层： 发布层1，发布层2</p>
<p>实验层： 非重叠测试区域，UI层、广告检索层、算法排序层。</p>
<h2 id="用户画像及其他受众定向基本概念"><a class="markdownIt-Anchor" href="#用户画像及其他受众定向基本概念"></a> 用户画像及其他：受众定向基本概念</h2>
<h3 id="p4受众定向方法分类"><a class="markdownIt-Anchor" href="#p4受众定向方法分类"></a> P4.受众定向方法分类</h3>
<p>受众定向即为（a，u，c）打标签的过程</p>
<ul>
<li>上下文标签可以认为是即时受众标签</li>
</ul>
<p>标签的两大主要作用</p>
<ul>
<li>建立面向广告主的流量售卖体系</li>
<li>为各估计模块（如CTR预测）提供特征</li>
</ul>
<h3 id="p4常见受众定向方式"><a class="markdownIt-Anchor" href="#p4常见受众定向方式"></a> P4.常见受众定向方式</h3>
<ul>
<li>地域定向（Geo-targeting） 【刚需】</li>
<li>人口属性定向（Demographical targeting）
<ul>
<li>年龄、性别、教育程度、收入水平</li>
<li>可监测，难获得，对效果意义有限</li>
</ul>
</li>
<li>频道定向（Channel targeting）</li>
<li>精确位置定向（Hyper-local Targeting）
<ul>
<li>利用蜂窝信息或者GPS获得精准位置，适用于O2O广告主</li>
</ul>
</li>
<li>上下文定向、行为定向</li>
<li>重定向（Retargetiing）
<ul>
<li>针对广告主老用户或者相关用户进行再营销，属于定制化用户标签</li>
<li>主要利用第一方数据</li>
</ul>
</li>
<li>新客推荐（Look-alike）
<ul>
<li>根据对广告主提供的种子用户，为其找到相关的新客</li>
<li>同时利用第一方数据和第二方数据</li>
</ul>
</li>
<li>动态定价（Dynamic pricing）
<ul>
<li>并不是一种广告定向技术、但对价格敏感人群有筛选作用</li>
</ul>
</li>
</ul>
<h3 id="p4受众定向标签体系"><a class="markdownIt-Anchor" href="#p4受众定向标签体系"></a> P4.受众定向标签体系</h3>
<p>结构化标签体系</p>
<ul>
<li>按照某分类法（Taxonomy）制定一个层次标签体系，父节点与子节点在人群覆盖上是包含关系</li>
<li>主要用于面向品牌广告的手中定向，特别常用于GD系统中</li>
</ul>
<p>非结构化标签体系</p>
<ul>
<li>根据某类定向需求设置标签，标签并不能为同一个分类体系中所描述</li>
<li>适合于多种目标、特别是效果目标并存的广告主的精准流量选择要求</li>
</ul>
<p>关键词</p>
<ul>
<li>按照搜索或浏览内容的关键词划分人群</li>
<li>非结构化，容易理解，但操作和优化不容易</li>
</ul>
<h3 id="标签体系一般设计思路"><a class="markdownIt-Anchor" href="#标签体系一般设计思路"></a> 标签体系一般设计思路</h3>
<p>分行业制定标签体系</p>
<ul>
<li>掌握各行业用户决策逻辑，依此制定标签体系</li>
<li>不必拘泥于完备的分类法（Ontology）</li>
</ul>
<p>行业化标签体系距离</p>
<ul>
<li>汽车行业：价格 车型 品牌</li>
<li>电商行业：单品、单品、单品</li>
<li>游戏行业：对每款游戏扩展竞品</li>
<li>母婴行业：孩子的年龄</li>
</ul>
<h3 id="受众定向与用户画像"><a class="markdownIt-Anchor" href="#受众定向与用户画像"></a> 受众定向与用户画像</h3>
<p>受众定向</p>
<ul>
<li>强调根据需求找到相应的用户</li>
<li>重点是可优化而非可验证</li>
<li>例：某运动鞋的目标受众、某游戏的高付费人群</li>
</ul>
<p>用户画像</p>
<ul>
<li>强调获得用户固有的可解释属性</li>
<li>在一定程度上可验证，例如，人口属性、生活方式、职业特征、收入状况</li>
</ul>
<h2 id="用内容解读任务上下文定向"><a class="markdownIt-Anchor" href="#用内容解读任务上下文定向"></a> 用内容解读任务：上下文定向</h2>
<h3 id="p4上下文定向原理"><a class="markdownIt-Anchor" href="#p4上下文定向原理"></a> P4.上下文定向原理</h3>
<p>根据用户正在浏览的页面和其他信息投送广告</p>
<h3 id="p4上下文定向主要方式"><a class="markdownIt-Anchor" href="#p4上下文定向主要方式"></a> P4.上下文定向主要方式</h3>
<p>举例</p>
<ul>
<li>地域定向、频道/URL定向，页面内容定向</li>
</ul>
<p>常用方法</p>
<ul>
<li>用规则将页面归类到一些频道或者主题分类</li>
<li>抓取页面中的关键词</li>
<li>提取页面入链锚文本中的关键词</li>
<li>提取页面流量来源中的搜索关键词</li>
<li>用主题模型将页面内容映射到语义空间的一组主题上</li>
</ul>
<h3 id="a1-半在线near-line抓取系统"><a class="markdownIt-Anchor" href="#a1-半在线near-line抓取系统"></a> A1. 半在线（Near-line）抓取系统</h3>
<ul>
<li>用在线cache系统存储url -&gt; 特征表以提供实时访问</li>
<li>不预先加载任何cache内容，对cache中不存在的url，立刻返回空特征，同时触发相应的页面爬虫和特征提取</li>
<li>设置cache系统合适的失效时间已完成特征自动更新</li>
</ul>
<blockquote>
<p>思考：上下文定向目前并非主流的定向方式，这反映了什么问题？</p>
</blockquote>
<h2 id="将内容变成概念文本主题模型"><a class="markdownIt-Anchor" href="#将内容变成概念文本主题模型"></a> 将内容变成概念：文本主题模型</h2>
<h3 id="文本主题模型概要"><a class="markdownIt-Anchor" href="#文本主题模型概要"></a> 文本主题模型概要</h3>
<p>问题</p>
<ul>
<li>发现一组文档中抽象的主题（topics）</li>
</ul>
<p>输入</p>
<ul>
<li>一组文档$\left {d_1,d_2,…,d_N \right } $</li>
<li>文档dN的BoW表示：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">{</mo><msub><mi>X</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>X</mi><mrow><mi>n</mi><mi>M</mi></mrow></msub><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left \{X_{n1},X_{n2},...,X_{nM}\right \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span></li>
<li>文档矩阵：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mo fence="true">{</mo><msub><mi>X</mi><mrow><mi>n</mi><mi>m</mi></mrow></msub><mo fence="true">}</mo></mrow><mrow><mi>N</mi><mo>∗</mo><mi>M</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\left \{X_{nm} \right \}_{N*M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0497em;vertical-align:-0.29969999999999997em;"></span><span class="minner"><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.07847em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17863099999999998em;"><span style="top:-2.4003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span><span class="mbin mtight">∗</span><span class="mord mathdefault mtight" style="margin-right:0.10903em;">M</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29969999999999997em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p>输出</p>
<ul>
<li>各文档得T个主题上的强度:<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo fence="true">{</mo><msub><mi>z</mi><mrow><mi>n</mi><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>z</mi><mrow><mi>n</mi><mn>2</mn></mrow></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>z</mi><mrow><mi>n</mi><mi>T</mi></mrow></msub><mo fence="true">}</mo></mrow><annotation encoding="application/x-tex">\left \{ z_{n1}, z_{n2},...,z_{nT} \right \}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.04398em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">}</span></span></span></span></span></li>
</ul>
<h3 id="常用文本主题模型"><a class="markdownIt-Anchor" href="#常用文本主题模型"></a> 常用文本主题模型</h3>
<p>LSA（Latent Semantic Analysis）</p>
<ul>
<li>文档矩阵的奇异值分解</li>
<li>选中前K个奇异值进行近似</li>
</ul>
<p>PLSI（Probabilistic Latent Semantic Indexing）</p>
<ul>
<li>将LSA变成了一个概率化的版本</li>
</ul>
<p>LDA（Latent Dirichlet Allocation）</p>
<ul>
<li>PLSI的贝叶斯版本</li>
<li>优化目标函数</li>
<li>可用变分法或Gibbs sampling方法求解</li>
</ul>
<p>词嵌入模型</p>
<ul>
<li>考虑了词的先后顺序关系</li>
</ul>
<h2 id="用数据理解用户行为定向"><a class="markdownIt-Anchor" href="#用数据理解用户行为定向"></a> 用数据理解用户：行为定向</h2>
<h3 id="p4行为定向behavioral-targeting"><a class="markdownIt-Anchor" href="#p4行为定向behavioral-targeting"></a> P4.行为定向（Behavioral targeting）</h3>
<ul>
<li>根据用户历史上网记录和其他数据计算出用户兴趣，根据此投放广告</li>
</ul>
<h3 id="p4行为定向数据来源"><a class="markdownIt-Anchor" href="#p4行为定向数据来源"></a> P4.行为定向数据来源</h3>
<p>决策行为</p>
<ul>
<li>转化（Conversion），预转化（Pre-conversion）</li>
<li>对应着非常明确的用户兴趣，价值最高</li>
</ul>
<p>主动行为</p>
<ul>
<li>搜索（Search）、广告点击（Ad click）、搜索点击（Search click）</li>
<li>在明确意图支配下主动产生的行为，价值也很高</li>
</ul>
<p>半主动行为</p>
<ul>
<li>分享（Share）、网页浏览（Page View）</li>
<li>量最大，用户意图最弱，也有一定价值</li>
</ul>
<p>被动行为</p>
<ul>
<li>广告浏览（Ad View）</li>
<li>负面的加权因素</li>
</ul>
<p>用户ID</p>
<ul>
<li>最重要的数据，一串0前面的那个1</li>
<li>稳定、精准的用户ID能大幅提高行为数据使用效率</li>
</ul>
<p>社交关系</p>
<ul>
<li>可以用于用户兴趣的平滑：当某个人的行为不足，无法进行精准的行为定向时，可以考虑借鉴其社交网络朋友的行为和兴趣。</li>
</ul>
<h3 id="p4各类行为的标签化方法"><a class="markdownIt-Anchor" href="#p4各类行为的标签化方法"></a> P4.各类行为的标签化方法</h3>
<h3 id="a1行为定向建模"><a class="markdownIt-Anchor" href="#a1行为定向建模"></a> A1.行为定向建模</h3>
<h3 id="a1行为定向特征选择过程"><a class="markdownIt-Anchor" href="#a1行为定向特征选择过程"></a> A1.行为定向特征选择过程</h3>
<h3 id="a1行为定向数据组织"><a class="markdownIt-Anchor" href="#a1行为定向数据组织"></a> A1.行为定向数据组织</h3>
<p>Session log</p>
<ul>
<li>将各种行为日志整理成以用户ID为key的形式，作为各数据处理模块的输入源，可以将targeting变成局部计算</li>
</ul>
<p>行为定向两种长期特征累积方式</p>
<ul>
<li>滑动窗方式</li>
<li>时间衰减方式</li>
</ul>
<h3 id="a1受众定向评测-reachctr曲线"><a class="markdownIt-Anchor" href="#a1受众定向评测-reachctr曲线"></a> A1.受众定向评测 - Reach/CTR曲线</h3>
<ul>
<li>Reach - target圈出来的人/总人数</li>
<li>右下角代表平均值</li>
<li>左边越高，受众定向效果越好</li>
</ul>
<h3 id="a1人口属性定向"><a class="markdownIt-Anchor" href="#a1人口属性定向"></a> A1.人口属性定向</h3>
<p>人口属性</p>
<ul>
<li>由于监测的原因，实践中主要使用的是性别、年龄</li>
<li>在传统广告中为人群选择的主要语言</li>
</ul>
<p>人口属性定向</p>
<ul>
<li>以性别定向为例，为二分类问题</li>
<li>需要有一定数量的标注样本，特征则来自用户行为</li>
</ul>
<blockquote>
<p>思考：行为定向为什么没有采用深度学习这类复杂的算法？</p>
</blockquote>
<h2 id="分布式计算平台"><a class="markdownIt-Anchor" href="#分布式计算平台"></a> 分布式计算平台</h2>
<h3 id="s5离线大数据平台"><a class="markdownIt-Anchor" href="#s5离线大数据平台"></a> S5.离线大数据平台</h3>
<h3 id="s5flume-by-cloudera"><a class="markdownIt-Anchor" href="#s5flume-by-cloudera"></a> S5.flume by cloudera</h3>
<p>高可用的，高可靠的，分布式的海量日志采集、聚合和传输的系统</p>
<ul>
<li>数据源：console、text、Thrift-RPC、tail、syslog</li>
<li>数据目的：console，dfs、Thrift-RPC</li>
<li>syslog TCP</li>
</ul>
<p>其他产品选择</p>
<ul>
<li>Scribe、Chukwa、KafKa</li>
</ul>
<h3 id="s5redis-by-wmware"><a class="markdownIt-Anchor" href="#s5redis-by-wmware"></a> S5.Redis by wmware</h3>
<p>一个KV存储系统</p>
<ul>
<li>Value可以支持string、list、set、zset、Hash</li>
<li>支持push/pop、add/remove等操作</li>
<li>高性能、使用简单，提供多种语言API</li>
</ul>
<p>注意事项</p>
<ul>
<li>避免让批量写影响在线服务的读性能</li>
<li>尽量用自更新的方式减少数据输入</li>
</ul>
<p>类似产品选择：Memcached</p>
<h2 id="如何利用合约市场合约广告需求方产品"><a class="markdownIt-Anchor" href="#如何利用合约市场合约广告需求方产品"></a> 如何利用合约市场：合约广告需求方产品</h2>
<h3 id="合约市场的优缺点"><a class="markdownIt-Anchor" href="#合约市场的优缺点"></a> 合约市场的优缺点</h3>
<p>优点</p>
<ul>
<li>有投放量的保证，确保人群触达</li>
<li>有时可以有竞品排他服务</li>
<li>活动类营销可以利用CPT位置获得冲击式曝光</li>
</ul>
<p>缺点</p>
<ul>
<li>很难利用精细的用户数据</li>
<li>溢价相对较高，媒体作弊相对容易</li>
</ul>
<h3 id="合约市场的利用与选择"><a class="markdownIt-Anchor" href="#合约市场的利用与选择"></a> 合约市场的利用与选择</h3>
<p>主要的合约广告产品</p>
<ul>
<li>综合或垂直门户的首页广告位</li>
<li>视频网站贴片港澳</li>
<li>移动应用开屏港澳</li>
</ul>
<p>应该如何选择</p>
<ul>
<li>宣传活动的品牌广告，可以选择高曝光的CPT广告</li>
<li>日常品牌触达广告，可以结合受众购买CPM广告</li>
</ul>
<h3 id="广告监播"><a class="markdownIt-Anchor" href="#广告监播"></a> 广告监播</h3>
<p>产品目的</p>
<ul>
<li>广告主委托第三方公司，对实际发生的展示或点击数目进行核对（AdMaster、秒针）</li>
<li>主要适用于按CPM结算的合约广告</li>
<li>按CPC、CPA结算的效果广告对此需求不大</li>
</ul>
<p>难点</p>
<ul>
<li>人口属性、地域等的监测</li>
<li>样本和总体之间的校正</li>
</ul>
<h3 id="广告安全"><a class="markdownIt-Anchor" href="#广告安全"></a> 广告安全</h3>
<p>广告投放验证（Ad verification）</p>
<ul>
<li>确认品牌的安全性，防止广告出现在对品牌有伤害的页面上。（例：优衣库出现在钓鱼岛新闻上）</li>
<li>页面内容不符合品牌诉求，则展示与品牌无关的创意</li>
<li>与广告监播不同，重点在于阻止不恰当展示的发生</li>
<li>可以Pre-bid进行</li>
</ul>
<p>可视性（Viewability）验证</p>
<ul>
<li>验证广告展示的曝光程度</li>
<li>判断浏览器是否对广告创意发生了渲染过程</li>
</ul>
<blockquote>
<p>思考：品牌广告的钱是不是比较好挣？</p>
</blockquote>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E8%AE%A1%E7%AE%97%E5%B9%BF%E5%91%8A/">计算广告</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E8%AE%A1%E7%AE%97%E5%B9%BF%E5%91%8A/">计算广告</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%90%88%E7%BA%A6%E5%B9%BF%E5%91%8A/">合约广告</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              

              <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5495814268572722"
                  crossorigin="anonymous"></script>
              <ins class="adsbygoogle"
                  style="display:block"
                  data-ad-client="ca-pub-4128258433761966"
                  data-ad-slot="1528926940"
                  data-ad-format="auto"
                  data-full-width-responsive="true"></ins>
              <script>
                  (adsbygoogle = window.adsbygoogle || []).push({});
              </script>

              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/06/18/computing-advertising-5-lean-data-monetization/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">计算广告|5.竞价广告-精细数据变现</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/06/12/computing-advertising-3-related-knowledge/">
                        <span class="hidden-mobile">计算广告|3.相关方法</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                

              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
    
  </div>
  

  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        陕ICP备20008129号
      </a>
    </span>
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css" />
  








  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?0c64a5657309290fd8f5efe33fcbcdb4";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'UA-166608124-1', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  
    <!-- Google gtag.js -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PKN25ZF7R2"></script>
    <script defer>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-PKN25ZF7R2');
    </script>
  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
