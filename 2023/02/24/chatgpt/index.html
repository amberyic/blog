

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon/apple-touch-icon.png">
  <link rel="icon" href="/img/favicon/favicon-32x32.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="ZhangHao">
  <meta name="keywords" content="ChatGPT,InstructGPT">
  
    <meta name="description" content="ChatGPT模型的三层理解，1）训练流程：白话讲解模型是怎么训练出来的。2）模型实现：基于论文讲解模型训练的细节，包括训练数据的准备，以及模型的训练方法。3）发展脉络：从模型演进的视角看其创新点和贡献。">
<meta property="og:type" content="article">
<meta property="og:title" content="ChatGPT模型的三层理解">
<meta property="og:url" content="https://imzhanghao.com/2023/02/24/chatgpt/index.html">
<meta property="og:site_name" content="张浩在路上">
<meta property="og:description" content="ChatGPT模型的三层理解，1）训练流程：白话讲解模型是怎么训练出来的。2）模型实现：基于论文讲解模型训练的细节，包括训练数据的准备，以及模型的训练方法。3）发展脉络：从模型演进的视角看其创新点和贡献。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302240527749.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141132504.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141133884.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141131855.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141155611.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141153648.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141337882.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141407380.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141408181.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302141453190.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161318246.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161135589.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161137916.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161333564.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161321218.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302170628736.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161450605.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302170636619.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161741774.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161736793.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302170633404.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302161926570.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302240534919.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/20210526143504.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/20210526141037.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/20210526150157.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302240536840.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202109290538512.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302171642998.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302171650512.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302181424811.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302181434145.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302201150042.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302201152876.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302201404574.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302201425975.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302201426679.png">
<meta property="og:image" content="https://oss.imzhanghao.com/img/202302240540923.png">
<meta property="article:published_time" content="2023-02-24T02:00:00.000Z">
<meta property="article:modified_time" content="2023-02-23T16:00:00.000Z">
<meta property="article:author" content="ZhangHao">
<meta property="article:tag" content="ChatGPT">
<meta property="article:tag" content="InstructGPT">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://oss.imzhanghao.com/img/202302240527749.png">
  
  
  <title>ChatGPT模型的三层理解 - 张浩在路上</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"imzhanghao.com","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"baidu":"0c64a5657309290fd8f5efe33fcbcdb4","google":"UA-166608124-1","gtag":"G-PKN25ZF7R2","tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.0.0"><link rel="alternate" href="/atom.xml" title="张浩在路上" type="application/atom+xml">
</head>


<body>
  <header style="height: 45vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>张浩在路上</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/technology/">
                <i class="iconfont icon-bug"></i>
                技术
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/monetization/">
                <i class="iconfont icon-briefcase"></i>
                变现
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/thinking/">
                <i class="iconfont icon-books"></i>
                思考
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                分类
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="ChatGPT模型的三层理解">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2023-02-24 10:00" pubdate>
        2023年2月24日 上午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      11k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      93 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">ChatGPT模型的三层理解</h1>
            
            <div class="markdown-body">
              <p>目前chatGPT的论文还没有公布，官方介绍里面讲：“ChatGPT is a sibling model to InstructGPT”，对比ChatGPT官网的模型训练流程和InstructGPT的流程图，基本是一致的，只是ChatGPT基于GPT-3.5进行的训练，我们下面的讲解就暂时以InstructGPT代替ChatGPT展开。</p>
<p><img src="https://oss.imzhanghao.com/img/202302240527749.png" srcset="/img/loading.gif" lazyload alt="ChatGPT vs InstructGPT" /></p>
<h2 id="第一层训练流程"><a class="markdownIt-Anchor" href="#第一层训练流程"></a> 第一层：训练流程</h2>
<blockquote>
<p>白话讲解ChatGPT的训练流程，不涉及模型训练细节，主要讲解整个训练是如何完成的。</p>
</blockquote>
<p>ChatGPT学习的四阶段</p>
<h3 id="11-第一步学习文字接龙"><a class="markdownIt-Anchor" href="#11-第一步学习文字接龙"></a> 1.1 第一步：学习文字接龙</h3>
<p><img src="https://oss.imzhanghao.com/img/202302141132504.png" srcset="/img/loading.gif" lazyload alt="GPT文字接龙" /><br />
GPT（Generative Pre-trained Transformer）是一个会<strong>文字接龙</strong>的模型，给他一段文本，他会预测下一个字是什么。</p>
<p><img src="https://oss.imzhanghao.com/img/202302141133884.png" srcset="/img/loading.gif" lazyload alt="样本生成逻辑" /><br />
训练一个文字接龙的模型是<strong>不需要人工标注的文本的</strong>，只需要在网上收集大量的文字，就可以学文字接龙这件事情。</p>
<p><img src="https://oss.imzhanghao.com/img/202302141131855.png" srcset="/img/loading.gif" lazyload alt="真实的输出" /><br />
GPT真实的输出是一个概率分布，“你好”的输入，可能跟“高”、“美”、“吗”等等词，每一次的输出都是不同的，出现的概率也不一样。</p>
<p><img src="https://oss.imzhanghao.com/img/202302141155611.png" srcset="/img/loading.gif" lazyload alt="文字接龙回答问题" /><br />
文字接龙已经可以用来回答问题了，但是…</p>
<p><img src="https://oss.imzhanghao.com/img/202302141153648.png" srcset="/img/loading.gif" lazyload alt="每次的输出都不同" /></p>
<p>GPT输出的是一个概率分布，后面可以接各式各样的句子，很多并不是我们想要的。<br />
那我们如何引导GPT产生有用的输出呢？</p>
<h3 id="12-第二步人类老师引导文字接龙方向"><a class="markdownIt-Anchor" href="#12-第二步人类老师引导文字接龙方向"></a> 1.2 第二步：人类老师引导文字接龙方向</h3>
<p>找人来思考想问GPT的问题，并人工提供正确答案。</p>
<ul>
<li>西安的地标是什么？ --&gt; 钟楼</li>
<li>如何学习深度学习？ --&gt;  需要先知道基本概念…</li>
<li>请把这句话做翻译…</li>
</ul>
<p>让原始的GPT模型在这部分质量较高的数据集上学习，多看一些有益的句子，期待他能产生出有用的输出。这里不需要穷尽所有问题，只需要告诉GPT人类的偏好。</p>
<h3 id="13-第三步模仿人类老师的喜好"><a class="markdownIt-Anchor" href="#13-第三步模仿人类老师的喜好"></a> 1.3 第三步：模仿人类老师的喜好</h3>
<p>训练一个模仿老师的模型，学习人类老师评分高低的标准。<br />
<img src="https://oss.imzhanghao.com/img/202302141337882.png" srcset="/img/loading.gif" lazyload alt="模仿人类老师的喜好" /></p>
<p>如果人类提交的是“钟楼”这个答案好于“谁来告诉我呀”，那么Teacher Model给“钟楼”这个的打分就要比“谁来告诉我呀”的打分高。</p>
<h3 id="14-第四步用强化学习向模拟老师学习"><a class="markdownIt-Anchor" href="#14-第四步用强化学习向模拟老师学习"></a> 1.4 第四步：用强化学习向模拟老师学习</h3>
<p>把“接龙模型GPT”和“老师模型Teacher Model”组合起来使用。</p>
<p><img src="https://oss.imzhanghao.com/img/202302141407380.png" srcset="/img/loading.gif" lazyload alt="强化学习" /></p>
<p>Teacher Model通过前面的学习已经学到，如果答案是一个问句，它不是一个好的答案，给予低分。这个Teacher Model输出的低分就是强化学习的奖励Reward，强化学习通过调整参数，得到最大的Reward</p>
<p><img src="https://oss.imzhanghao.com/img/202302141408181.png" srcset="/img/loading.gif" lazyload alt="强化学习" /><br />
经过强化学习以后，GPT就变成了ChatGPT，能够输出我们想要的答案了。</p>
<blockquote>
<p>总结：整个过程就是教GPT从“<strong>想说什么就说什么</strong>”到“<strong>说人类想要他说的</strong>”。</p>
</blockquote>
<h2 id="第二层工程实现"><a class="markdownIt-Anchor" href="#第二层工程实现"></a> 第二层：工程实现</h2>
<blockquote>
<p>重点讲解Instruct GPT的论文，《Training language models to follow instructions with human feedback》(训练语言模型是他能够服从人类的指示)。68页的论文主要内容在讲工程实现，包括怎么挑选合适的标注人员，各个模型都是如何准备训练数据的，甚至还给了很多标注表格的模板和训练样本范例。</p>
</blockquote>
<p>大型语言模型中的一致性问题通常表现为：</p>
<ul>
<li><strong>提供无效帮助</strong>：没有遵循用户的明确指示。</li>
<li><strong>内容胡编乱造</strong>：虚构不存在或错误事实的模型。</li>
<li><strong>缺乏可解释性</strong>：人们很难理解模型是如何得出特定决策或预测的。</li>
<li><strong>内容偏见有害</strong>：一个基于有偏见、有害数据训练的语言模型可能会在其输出中出现这种情况，即使它没有明确指示这样做。</li>
</ul>
<p><img src="https://oss.imzhanghao.com/img/202302141453190.png" srcset="/img/loading.gif" lazyload alt="three steps of Instruct GPT" /></p>
<p>InstructGPT/ChatGPT的提出了一种利用人类反馈来解决这一问题的方案，方法总体上可以分成3步：</p>
<ul>
<li>根据采集的SFT数据集对GPT-3进行有监督的微调（Supervised FineTune，SFT）；</li>
<li>收集人工标注的对比数据，训练奖励模型（Reword Model，RM）；</li>
<li>使用RM作为强化学习的优化目标，利用PPO算法微调SFT模型。</li>
</ul>
<h3 id="21-数据来源"><a class="markdownIt-Anchor" href="#21-数据来源"></a> 2.1 数据来源</h3>
<p>训练数据有两个来源：</p>
<ul>
<li>由我们的标注人员编写的Prompt数据集</li>
<li>提交给早期 InstructGPT模型版本API的Prompt数据集</li>
</ul>
<p><strong>标记人员</strong></p>
<p>OpenAI通过一系列的筛选，找到了<strong>40</strong>个对不同人口群体的偏好敏感并且善于识别可能有害的输出的<strong>全职</strong>标记人员。整个过程中，OpenAI的研发人员跟这些标记人员紧密合作，给他们进行了培训，并对他们是否能够代表大众的偏好进行了评测。</p>
<p>标记人员的工作是根据内容自己编写prompt，并且要求编写的Prompt满足下面三点：</p>
<ul>
<li><strong>简单任务</strong>：标记人员给出任意简单的任务，同时要确保任务的多样性；</li>
<li><strong>Few-shot任务</strong>：标注人员写出一个指示，同时写出其各种不同说法。</li>
<li><strong>用户相关的</strong>：从接口中获取用例，然后让标记人员根据这些用例编写prompt。</li>
</ul>
<p><img src="https://oss.imzhanghao.com/img/202302161318246.png" srcset="/img/loading.gif" lazyload alt="标记人员分布" /></p>
<p>40名外包员工来自美国和东南亚，分布比较集中且人数较少， InstructGPT/ChatGPT的目标是训练一个价值观正确的预训练模型，它的价值观是由这40个外包员工的价值观组合而成。而这个比较窄的分布可能会生成一些其他地区比较在意的歧视，偏见问题。</p>
<p><strong>API用户</strong></p>
<p>OpenAI训练了一个早期版本的InstructGPT，开放给了一部分用户，根据他们提问信息构造样本，对数据集做了如下操作：</p>
<ul>
<li>删除了一些重复的、包含个人信息的prompt；</li>
<li>每个用户只取200条prompt；</li>
<li>按照用户ID划分训练集、验证集和测试集，避免类似问题同时出现在训练集和验证集。</li>
</ul>
<p><img src="https://oss.imzhanghao.com/img/202302161135589.png" srcset="/img/loading.gif" lazyload alt="API prompt dataset" /></p>
<p>prompt种类共有9种，而且绝大多数是生成类任务，可能会导致模型有覆盖不到的任务类型；</p>
<h3 id="22-训练数据"><a class="markdownIt-Anchor" href="#22-训练数据"></a> 2.2 训练数据</h3>
<p>基于上面的数据集，生成了三份不同的训练数据集：</p>
<table>
<thead>
<tr>
<th>数据集</th>
<th>生成方法</th>
<th>prompt量</th>
<th>训练任务</th>
</tr>
</thead>
<tbody>
<tr>
<td>SFT dataset</td>
<td>由标记人员编写prompt对应的回答</td>
<td>13k</td>
<td>Supervised FineTune(SFT)</td>
</tr>
<tr>
<td>RM dataset</td>
<td>由标记人员对gpt产生的答案进行质量排序</td>
<td>33k</td>
<td>Reword Model(RM)</td>
</tr>
<tr>
<td>PPO dataset</td>
<td>不需要人工参与，gpt产生结果，RM进行打分</td>
<td>31k</td>
<td>Reinforcement learning (RL)</td>
</tr>
</tbody>
</table>
<p><img src="https://oss.imzhanghao.com/img/202302161137916.png" srcset="/img/loading.gif" lazyload alt="prompt" /></p>
<p>数据中96%以上是英文，其它20个语种例如中文，法语，西班牙语等加起来不到4%，这可能导致InstructGPT/ChatGPT能进行其它语种的生成时，效果应该远不如英文；</p>
<h3 id="23-模型微调supervised-fine-tuningsft"><a class="markdownIt-Anchor" href="#23-模型微调supervised-fine-tuningsft"></a> 2.3 模型微调Supervised fine-tuning（SFT）</h3>
<p><img src="https://oss.imzhanghao.com/img/202302161333564.png" srcset="/img/loading.gif" lazyload alt="神经网络可视化" /><br />
低层的网络主要学习图像的边缘或色斑，中层的网络主要学习物体的局部和纹理，高层的网络识别抽象的语义。</p>
<p>由上面的案例可知，我们可以把一个神经网络分成两块：1）低层的网络进行特征抽取，将原始信息变成容易被后面任务使用的特征；2）输出层的网络进行具体任务的预测。输出层因为涉及到具体任务没办法在不同任务中复用，但是低层的网络是具有通用型的，可以应用到其他任务上。</p>
<p><img src="https://oss.imzhanghao.com/img/202302161321218.png" srcset="/img/loading.gif" lazyload alt="微调" /><br />
微调由以下4步构成：</p>
<ul>
<li>在源数据集上<strong>预训练</strong>一个神经网络模型，即源模型。</li>
<li>创建一个新的神经网络模型，即目标模型。它<strong>复制</strong>了源模型上除了输出层外的所有模型设计及其参数。我们假设这些模型参数包含了源数据集上学习到的知识，且这些知识同样适用于目标数据集。我们还假设源模型的输出层与源数据集的标签紧密相关，因此在目标模型中不予采用。</li>
<li>为目标模型添加一个输出大小为目标数据集类别个数的<strong>输出层</strong>，并随机初始化该层的模型参数。</li>
<li>在目标数据集上<strong>训练目标模型</strong>。我们将从头训练输出层，而其余层的参数都是基于源模型的参数微调得到的。</li>
</ul>
<p><img src="https://oss.imzhanghao.com/img/202302170628736.png" srcset="/img/loading.gif" lazyload alt="SFT" /></p>
<p>这里的SFT就是基于训练好的GPT-3模型进行的微调，在数据集上面进行了16个epoch的训练，数据量比较小，模型比较大，一个epoch以后就过拟合了，但是论文里面说这个没关系，因为他不是直接拿出去用，而是用来初始化后面的模型。</p>
<h3 id="24-训练奖励模型reward-modelingrm"><a class="markdownIt-Anchor" href="#24-训练奖励模型reward-modelingrm"></a> 2.4 训练奖励模型Reward modeling（RM）</h3>
<p>一个Response不能给具体的打分值，只能说一个Response比另一个Response更好或者差不多，所以训练奖励模型的数据是一个标注人员根据生成结果排序的形式，它可以看做一个回归模型。</p>
<p><img src="https://oss.imzhanghao.com/img/202302161450605.png" srcset="/img/loading.gif" lazyload alt="pairwise" /><br />
奖励模型使用的是PairWise的训练方法，PairWise的基本思路是对样本进行两两比较，构建偏序文档对，从比较中学习顺序。PairWise就是希望通过正确估计一对文档的顺序，而得到整体的正确顺序，比如一个正确的排序为：“A&gt;B&gt;C”，PairWise通过学习两两之间的关系“A&gt;B”，“B&gt;C”和“A&gt;C”来推断“A&gt;B&gt;C”。</p>
<p><img src="https://oss.imzhanghao.com/img/202302170636619.png" srcset="/img/loading.gif" lazyload alt="RM" /><br />
奖励模型的结构是将SFT训练后的模型的最后的嵌入层去掉后的模型。它的输入是prompt和Reponse，输出是奖励值。GPT-3最大的模型时175B的，但是发现这种规模的模型训练不稳定，最后才用了6B的版本。</p>
<h3 id="25-强化学习reinforcement-learningrl"><a class="markdownIt-Anchor" href="#25-强化学习reinforcement-learningrl"></a> 2.5 强化学习Reinforcement learning（RL）</h3>
<p><img src="https://oss.imzhanghao.com/img/202302161741774.png" srcset="/img/loading.gif" lazyload alt="强化学习" /><br />
强化学习（Reinforcement learning，RL）讨论的问题是一个智能体（agent）怎么在一个复杂不确定的 环境（environment) 里面去极大化它能获得的奖励。通过感知所处环境的 状态（state) 对 动作（action） 的反应（reward），来指导更好的动作，从而获得最大的收益（return），这被称为在交互中学习，这样的学习方法就被称作强化学习。</p>
<p><img src="https://oss.imzhanghao.com/img/202302161736793.png" srcset="/img/loading.gif" lazyload alt="PPO" /></p>
<p>PPO（Proximal Policy Optimization）近端策略优化算法，是一种典型的强化学习算法。它通过观测信息选出一个行为直接进行反向传播，当然出人意料的是他并没有误差，而是利用reward奖励直接对选择行为的可能性进行增强和减弱，好的行为会被增加下一次被选中的概率，不好的行为会被减弱下次被选中的概率。</p>
<p><img src="https://oss.imzhanghao.com/img/202302170633404.png" srcset="/img/loading.gif" lazyload alt="RL" /><br />
这里我们随机取一个用户的prompt，然后使用SFT模型生成一个response，使用奖励模型对当前的prompt-response对打分作为Reward。</p>
<h3 id="26-结论"><a class="markdownIt-Anchor" href="#26-结论"></a> 2.6 结论</h3>
<p><img src="https://oss.imzhanghao.com/img/202302161926570.png" srcset="/img/loading.gif" lazyload alt="结论" /></p>
<p>该模型基于三个标准进行评估：</p>
<ul>
<li><strong>帮助性</strong>：判断模型遵循用户指示以及推断指示的能力。</li>
<li><strong>真实性</strong>：判断模型在封闭领域任务中有产生虚构事实的倾向。</li>
<li><strong>无害性</strong>：标注者评估模型的输出是否适当、是否包含歧视性内容。</li>
</ul>
<p>跟SFT 175B的模型对比效果，所以我们可以看到SFT 175B的胜率是0.5。</p>
<p>在对我们的prompt进行人工评估过程中，1.3B个参数的InstructGPT模型的输出优于 175B的GPT-3模型的输出，尽管参数少100倍。此外，InstructGPT模型显示了真实性的提高和有毒输出生成的减少，同时在公共数据集上的性能下降却很小。尽管InstructGPT 仍然会犯一些简单的错误，但我们的结果表明，<strong>根据人类反馈进行微调是使语言模型与人类意图保持一致的一个有前途的方向</strong>。</p>
<h2 id="第三层发展脉络"><a class="markdownIt-Anchor" href="#第三层发展脉络"></a> 第三层：发展脉络</h2>
<blockquote>
<p>任何模型的突破和成功，都不是一蹴而就的，是不断的学习前人的经验和结论，自己一步一步走出来的，这个需要的是厚积薄发。ChatGPT也是一样，要真正理解它，就需要看它之前的工作，从发展脉络的角度去看问题。</p>
</blockquote>
<p><img src="https://oss.imzhanghao.com/img/202302240534919.png" srcset="/img/loading.gif" lazyload alt="模型演进" /></p>
<h3 id="31-encoder-decoder"><a class="markdownIt-Anchor" href="#31-encoder-decoder"></a> 3.1 Encoder-Decoder</h3>
<p>Cho在2014年的《Learning Phrase Representations using RNN Encoder–Decoder for Statistical Machine Translation》中提出了Encoder–Decoder结构，它由两个RNN组成，另外本文还提出了GRU的门结构，相比LSTM更加简洁，而且效果不输LSTM。</p>
<p><img src="https://oss.imzhanghao.com/img/20210526143504.png" srcset="/img/loading.gif" lazyload alt="Encoder-Decoder框架" /></p>
<p>生成目标句子单词的过程成了下面的形式，其中f1是Decoder的非线性变换函数：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">Y</mi><mn mathvariant="bold">1</mn></msub><mo>=</mo><mi mathvariant="bold">f</mi><mn mathvariant="bold">1</mn><mrow><mo fence="true">(</mo><mi mathvariant="bold">C</mi><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">Y</mi><mn>2</mn></msub><mo>=</mo><mi mathvariant="bold">f</mi><mn mathvariant="bold">1</mn><mrow><mo fence="true">(</mo><mi mathvariant="bold">C</mi><mo separator="true">,</mo><msub><mi mathvariant="bold">Y</mi><mn mathvariant="bold">1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">Y</mi><mn>3</mn></msub><mo>=</mo><mi mathvariant="bold">f</mi><mn mathvariant="bold">1</mn><mrow><mo fence="true">(</mo><mi mathvariant="bold">C</mi><mo separator="true">,</mo><msub><mi mathvariant="bold">Y</mi><mn mathvariant="bold">1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">Y</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}
\mathbf{Y}_{\mathbf{1}}=\mathbf{f} \mathbf{1}\left(\mathbf{C}\right) \\
\mathbf{Y}_{2}=\mathbf{f} \mathbf{1}\left(\mathbf{C}, \mathbf{Y}_{\mathbf{1}}\right) \\
\mathbf{Y}_{3}=\mathbf{f} \mathbf{1}\left(\mathbf{C}, \mathbf{Y}_{\mathbf{1}}, \mathbf{Y}_{2}\right)
\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord"><span class="mord mathbf">1</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">C</span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord"><span class="mord mathbf">1</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">C</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord"><span class="mord mathbf">1</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathbf">C</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p>
<p>Encoder和Decoder部分可以是任意的文字、语音、图像和视频数据，模型可以采用CNN，RNN，BiRNN、LSTM、GRU等等，所以基于Encoder-Decoder的结构，我们可以设计出各种各样的应用算法。比如：1）<strong>文字-文字</strong>：机器翻译，对话机器人，文章摘要，代码补全； 2） <strong>音频-文字</strong>：语音识别； 3） <strong>图片-文字</strong>：图像描述生成</p>
<blockquote>
<p>Encoder-Decoder的出现，对于很多领域的影响是非常深远的，比如机器翻译的任务，再也不需要做词性分析、词典查询、语序调整和隐马尔可夫模型等等方案，几乎都是基于Encoder-Decoder框架的神经网络方案。</p>
</blockquote>
<h3 id="32-attention机制"><a class="markdownIt-Anchor" href="#32-attention机制"></a> 3.2 Attention机制</h3>
<p>Attention机制最早在视觉领域提出，2014年Google Mind发表了《Recurrent Models of Visual Attention》，使Attention机制流行起来，这篇论文采用了RNN模型，并加入了Attention机制来进行图像的分类。</p>
<p>2015年，Bahdanau等人在论文《Neural Machine Translation by Jointly Learning to Align and Translate》中，将attention机制首次应用在nlp领域，其采用Seq2Seq+Attention模型来进行机器翻译，并且得到了效果的提升。</p>
<p><img src="https://oss.imzhanghao.com/img/20210526141037.png" srcset="/img/loading.gif" lazyload alt="人类的视觉注意力" /></p>
<p>语义编码C是由句子Source的每个单词经过Encoder编码产生的，这意味着不论是生成哪个单词，其实句子Source中任意单词对生成某个目标单词来说影响力都是相同的，这是为何说这个模型没有体现出注意力的缘由。这类似于人类看到眼前的画面，但是眼中却没有注意焦点一样。</p>
<p>我们拿机器翻译来解释一下注意力在Encoder-Decoder模型中的作用就更好理解了，比如输入的是英文句子：Tom chase Jerry，Encoder-Decoder框架逐步生成中文单词：“汤姆”，“追逐”，“杰瑞”。</p>
<p>在翻译“杰瑞”这个中文单词的时候，没有注意力的模型里面的每个英文单词对于翻译目标单词“杰瑞”贡献是相同的，很明显这里不太合理，显然“Jerry”对于翻译成“杰瑞”更重要，但是没有注意力的模型是无法体现这一点的。</p>
<p>目标句子中的每个单词都应该学会其对应的源语句子中单词的注意力分配概率信息。这意味着在生成每个单词yi的时候，原先都是相同的中间语义表示C会被替换成根据当前生成单词而不断变化的Ci。理解Attention模型的关键就是这里，即<strong>由固定的中间语义表示C换成了根据当前输出单词来调整成加入注意力模型的变化的Ci</strong>。增加了注意力模型的Encoder-Decoder框架理解起来如图所示。</p>
<p><img src="https://oss.imzhanghao.com/img/20210526150157.png" srcset="/img/loading.gif" lazyload alt="引入注意力模型的Encoder-Decoder框架" /></p>
<p>即生成目标句子单词的过程成了下面的形式：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.15999999999999992em" columnalign="left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">Y</mi><mn mathvariant="bold">1</mn></msub><mo>=</mo><mi mathvariant="bold">f</mi><mn mathvariant="bold">1</mn><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">C</mi><mn mathvariant="bold">1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">Y</mi><mn>2</mn></msub><mo>=</mo><mi mathvariant="bold">f</mi><mn mathvariant="bold">1</mn><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">C</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">Y</mi><mn mathvariant="bold">1</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><msub><mi mathvariant="bold">Y</mi><mn>3</mn></msub><mo>=</mo><mi mathvariant="bold">f</mi><mn mathvariant="bold">1</mn><mrow><mo fence="true">(</mo><msub><mi mathvariant="bold">C</mi><mn>3</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">Y</mi><mn mathvariant="bold">1</mn></msub><mo separator="true">,</mo><msub><mi mathvariant="bold">Y</mi><mn>2</mn></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{array}{l}
\mathbf{Y}_{\mathbf{1}}=\mathbf{f} \mathbf{1}\left(\mathbf{C}_{\mathbf{1}}\right) \\
\mathbf{Y}_{2}=\mathbf{f} \mathbf{1}\left(\mathbf{C}_{2}, \mathbf{Y}_{\mathbf{1}}\right) \\
\mathbf{Y}_{3}=\mathbf{f} \mathbf{1}\left(\mathbf{C}_{3}, \mathbf{Y}_{\mathbf{1}}, \mathbf{Y}_{2}\right)
\end{array}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:3.6000000000000005em;vertical-align:-1.5500000000000007em;"></span><span class="mord"><span class="mtable"><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.21em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord"><span class="mord mathbf">1</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-3.0099999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord"><span class="mord mathbf">1</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span><span style="top:-1.8099999999999994em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.10903em;">f</span></span><span class="mord"><span class="mord mathbf">1</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord"><span class="mord mathbf">C</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbf mtight">1</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord"><span class="mord mathbf" style="margin-right:0.02875em;">Y</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.5500000000000007em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span></span></span></span></span></span></span></p>
<p><img src="https://oss.imzhanghao.com/img/202302240536840.png" srcset="/img/loading.gif" lazyload alt="attention机制添加以后的翻译的过程" /></p>
<blockquote>
<p>Attention机制由来已久，真正让其大放异彩的，是后来Google的一篇文章《Attention is All You Need》。</p>
</blockquote>
<h3 id="33-transformer"><a class="markdownIt-Anchor" href="#33-transformer"></a> 3.3 Transformer</h3>
<p>2017年，Google机器翻译团队发表的《Attention is All You Need》中，提出了他们的Transformer架构，Transformer基于经典的机器翻译Seq2Seq框架，完全抛弃了RNN和CNN等网络结构，而仅仅采用Attention机制来进行机器翻译任务，在WMT 2014的数据集上取得了很好的成绩。</p>
<p><img src="https://oss.imzhanghao.com/img/202109290538512.png" srcset="/img/loading.gif" lazyload alt="Transformer的架构" /></p>
<p><strong>编码器</strong><br />
编码器由N=6个相同的layer组成，layer指的就是上图左侧的单元，最左边有个“Nx”，这里是x6个。每个Layer由两个子层（Sub-Layer）组成,第一个子层是Multi-head Self-attention Mechanism，第二个子层比较简单，是Fully Connected Feed-Forward Network。其中每个子层都加了残差连接（Residual Connection）和层归一化（Layer Normalisation），因此可以将子层的输出表示为：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mtext> LayerNorm </mtext><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mi mathvariant="normal">SubLayer</mi><mo>⁡</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text { LayerNorm }(x+\operatorname{SubLayer}(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord"> LayerNorm </span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop"><span class="mord mathrm">S</span><span class="mord mathrm">u</span><span class="mord mathrm">b</span><span class="mord mathrm">L</span><span class="mord mathrm">a</span><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="mord mathrm">e</span><span class="mord mathrm">r</span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<p><strong>解码器</strong><br />
解码器同样由N=6个相同layer组成，因为编码器是并行计算一次性将结果直接输出，而解码器是一个词一个词输入，所以解码器除了每个编码器层中的两个子层之外，还插入第三子层，其对编码器堆栈的输出执行multi-head attention。每个子层也都加了残差连接（Residual Connection）和层归一化（Layer Normalisation）。解码器中对self-attention子层进行了修改，以防止引入当前时刻的后续时刻输入，这种屏蔽与输出嵌入偏移一个位置的事实相结合，确保了位置i的预测仅依赖于小于i的位置处的已知输出。</p>
<blockquote>
<p>Transformer出现后，开始取代RNN（循环神经网络）和 CNN（卷积神经网络）成为最热门的信息提取工具，以前做NLP（自然语言处理）研究的喜欢用RNN，做CV（计算机视觉）研究的喜欢用CNN，现在大家都用Transformer了，很多研究进展可以同步到另一个领域。</p>
</blockquote>
<h3 id="34-gpt"><a class="markdownIt-Anchor" href="#34-gpt"></a> 3.4 GPT</h3>
<p>传统的NLP模型往往使用大量的数据对有监督的模型进行任务相关的模型训练，但是高质量的标注数据往往很难获得，而且不同任务的模型很难泛化到其他任务上，所以OpenAI在《Imporoving Language Understanding By Generative Pre-training》提出先在大量的无标签数据上训练一个语言模型，然后再在下游具体任务的有标签数据集上进行fine-tune。</p>
<p>GPT是典型的<strong>预训练+微调</strong>的两阶段模型。预训练阶段就是用海量的文本数据通过无监督学习的方式来获取语言学知识，而微调就是用下游任务的训练数据来获得特定任务的模型。</p>
<p>举一个例子来形容预训练和微调的关系，我们从幼儿园到高中就像预训练过程，不断学习知识，这些知识包罗万象包括语数英物化生等等，最重要的特征就是预训练模型具有很好的通用性；然后读大学的时候需要确定一个专业方向作为未来的职业，所以就会去重点学习专业知识，从而让我们成为更加适合某个专业方向的人才，最重要的特征就是具有极强的专业性。</p>
<p><img src="https://oss.imzhanghao.com/img/202302171642998.png" srcset="/img/loading.gif" lazyload alt="gpt使用的是transformer的Decoder部分" /></p>
<p>GPT模型效果还是非常出色的，12个任务数据集中9个达到了最好效果。</p>
<h3 id="35-bert"><a class="markdownIt-Anchor" href="#35-bert"></a> 3.5 BERT</h3>
<p>2018年10月，Google发表《BERT_Pre-training of Deep Bidirectional Transformers for Language Understanding》，提出了类似于GPT的预训练模型BERT。</p>
<p><img src="https://oss.imzhanghao.com/img/202302171650512.png" srcset="/img/loading.gif" lazyload alt="bert使用的是transformer的Encoder部分" /></p>
<p>BERT和GPT采用了不同的技术路线，简单理解，BERT是一个双向模型，可以联系上下文进行分析，更擅长<strong>完形填空</strong>；而GPT是一个单项模型，只能从左到右进行阅读，更擅长<strong>写作文</strong>。</p>
<p>发布更早的GPT-1输给了晚4个月发布的BERT，而且是完败。在当时的竞赛排行榜上，阅读理解领域已经被BERT屠榜了。此后，BERT也成为了NLP领域最常用的模型。<br />
<img src="https://oss.imzhanghao.com/img/202302181424811.png" srcset="/img/loading.gif" lazyload alt="bert on GLUE" /></p>
<h3 id="36-gpt-2-gpt-3"><a class="markdownIt-Anchor" href="#36-gpt-2-gpt-3"></a> 3.6 GPT-2 &amp; GPT-3</h3>
<p>OpenAI既没有认输，也非常头铁。虽然GPT-1效果不如BERT，但OpenAI没有改变策略，而是坚持走大模型路线。接下来的两年（2019、2020年），在几乎没有改变模型架构的基础上，OpenAI 陆续推出参数更大的迭代版本GPT-2、GPT-3，前者有15亿参数，后者有1750亿参数，最终GPT-3的模型效果震惊世人，成功出圈。</p>
<table>
<thead>
<tr>
<th>模型</th>
<th>发布时间</th>
<th>层数</th>
<th>头数</th>
<th>词向量长度</th>
<th>参数量</th>
<th>预训练数据量</th>
</tr>
</thead>
<tbody>
<tr>
<td>GPT-1</td>
<td>2018 年 6 月</td>
<td>12</td>
<td>768</td>
<td>768</td>
<td>1.17 亿</td>
<td>约5GB</td>
</tr>
<tr>
<td>GPT-2</td>
<td>2019 年 2 月</td>
<td>48</td>
<td>-</td>
<td>1600</td>
<td>15 亿</td>
<td>40GB</td>
</tr>
<tr>
<td>GPT-3</td>
<td>2020 年 5 月</td>
<td>96</td>
<td>96</td>
<td>12888</td>
<td>1750 亿</td>
<td>45TB</td>
</tr>
</tbody>
</table>
<p>但是单纯的说用一个更大的模型打败了对手感觉还不够，GPT-2和3开始卷另一个方向，不用做梯度更新和微调依然可以完成很多任务，也就是Zero-shot。在OpenAI眼中，未来的通用人工智能应该长这个样子：<strong>有一个任务无关的超大型的语言模型（Large Language Model, LLM），用来从海量数据中学习各种知识，这个LLM以生成一切的方式，来解决各种各样的实际问题，而且它应该能听懂人类的命令，以便于人类使用。</strong></p>
<p><img src="https://oss.imzhanghao.com/img/202302181434145.png" srcset="/img/loading.gif" lazyload alt="Zero-shot, one-shot and few-shot, contrasted with traditional fine-tuning." /></p>
<blockquote>
<p>本身在这么大的模型上做梯度更新和微调就是一个门槛很高的事情，GPT-3模型对于Zero-shot、one-shot和few-shot的支持，使得基于他可以衍生出了上百个基于GPT-3的应用。</p>
</blockquote>
<h3 id="37-instruction-tuning"><a class="markdownIt-Anchor" href="#37-instruction-tuning"></a> 3.7 instruction Tuning</h3>
<p>Google在2021年发表《Finetuned Language Models are Zero-Shot Learners》，提出了一种提高语言模型Zero-shot能力的方法。</p>
<p>比如我们要进行一句话的情感分析，“带女朋友去了一家餐厅，她吃的很开心”，我们可以有两种做法：</p>
<ul>
<li>利用模型补全的能力，改造prompt：“带女朋友去了一家餐厅，她吃的很开心，这家餐厅太__了！”</li>
<li>直接告诉模型任务：“判断这句话的情感：带女朋友去了一家餐厅，她吃的很开心。选项：A=好，B=一般，C=差”<br />
instruction Tuning是第二种。</li>
</ul>
<p><img src="https://oss.imzhanghao.com/img/202302201150042.png" srcset="/img/loading.gif" lazyload alt="pretrain–finetune and prompting and instruction Tuning" /></p>
<p>Instruction tuning的动机是为了提高语言模型对instructions的<strong>理解和响应能力</strong>。其想法是，通过监督来教语言模型执行instructions描述的任务，从而使它将学习到如何遵循instructions，当面对unseen的任务时，模型自然而然地就会遵循instruction做出响应。<br />
<img src="https://oss.imzhanghao.com/img/202302201152876.png" srcset="/img/loading.gif" lazyload alt="instruction-tuning" /><br />
首先在包括commonsense reasoning、machine translation、sentiment analysis等NLP task上进行微调，然后在从未见过的natural language inference任务上进行zero-shot evaluation</p>
<p><img src="https://oss.imzhanghao.com/img/202302201404574.png" srcset="/img/loading.gif" lazyload alt="performance of zero-shot FLAN" /></p>
<h3 id="38-instructgptchatgpt"><a class="markdownIt-Anchor" href="#38-instructgptchatgpt"></a> 3.8 InstructGPT/ChatGPT</h3>
<p>InstructGPT论文《Training language models to follow instructions with human feedback》，我们已经讲清楚language models和instructions，剩下就是with human feedback。</p>
<p>人工反馈的强化学习（Reinforcement Learning from Human Feedback，RLHF）参考了OpenAI前面的两个工作。</p>
<p>Ziegler在2019年的《Fine-Tuning Language Models from Human Preferences》<br />
<img src="https://oss.imzhanghao.com/img/202302201425975.png" srcset="/img/loading.gif" lazyload alt="Ziegler et al. (2019)" /></p>
<p>Stiennon在2020年《Learning to summarize from human feedback》<br />
<img src="https://oss.imzhanghao.com/img/202302201426679.png" srcset="/img/loading.gif" lazyload alt="Stiennon et al. (2020)," /></p>
<p>ChatGPT和InstructGPT在模型结构，训练方式上都完全一致，即都使用了指示学习（Instruction Learning）和人工反馈的强化学习（Reinforcement Learning from Human Feedback，RLHF）来指导模型的训练，它们不同的仅仅是采集数据的方式上有所差异。</p>
<h2 id="写在最后"><a class="markdownIt-Anchor" href="#写在最后"></a> 写在最后</h2>
<h3 id="41-安全性"><a class="markdownIt-Anchor" href="#41-安全性"></a> 4.1 安全性</h3>
<p>2016年，微软AI Tay，种族歧视，下线。<br />
Microsoft shuts down AI chatbot after it turned into a Nazi。<br />
<a target="_blank" rel="noopener" href="https://www.cbsnews.com/news/microsoft-shuts-down-ai-chatbot-after-it-turned-into-racist-nazi/">https://www.cbsnews.com/news/microsoft-shuts-down-ai-chatbot-after-it-turned-into-racist-nazi/</a></p>
<p>2021年，Facebook，AI将黑人标上了灵长目的标签<br />
Facebook Apologizes After A.I. Puts ‘Primates’ Label on Video of Black Men<br />
Facebook called it “an unacceptable error.” The company has struggled with other issues related to race.<br />
<a target="_blank" rel="noopener" href="https://www.nytimes.com/2021/09/03/technology/facebook-ai-race-primates.html">https://www.nytimes.com/2021/09/03/technology/facebook-ai-race-primates.html</a></p>
<p>语言模型的输出特别灵活，导致出错的概率会更大，OpenAI作为一个创业公司，媒体对于GPT的容忍度大一些，如果是大公司做的GPT模型，可能已经下架了。</p>
<h3 id="42-成本"><a class="markdownIt-Anchor" href="#42-成本"></a> 4.2 成本</h3>
<p><img src="https://oss.imzhanghao.com/img/202302240540923.png" srcset="/img/loading.gif" lazyload alt="LLM模型" /></p>
<p>大模型背后离不开大数据、大算力。GPT-2用于训练的数据取自于Reddit上高赞的文章，数据集共有约800万篇文章，累计体积约40G；GPT-3模型的神经网络是在超过45TB的文本上进行训练的，数据相当于整个维基百科英文版的160倍。</p>
<p>在算力方面，GPT-3.5在微软Azure AI超算基础设施（由V100GPU组成的高带宽集群）上进行训练，总算力消耗约3640PF-days（即每秒一千万亿次计算，运行3640天）。可以说，大模型的训练就是靠烧钱烧出来的。据估算，OpenAI的模型训练成本高达1200万美元，GPT-3的单次训练成本高达460万美元。</p>
<p>根据《财富》杂志报道的数据，2022年OpenAI的收入为3000万美元的收入，但净亏损总额预计为5.445亿美元。阿尔特曼在Twitter上回答马斯克的问题时表示，在用户与ChatGPT的每次交互中OpenAI花费的计算成本为“个位数美分”，随着ChatGPT变得流行，每月的计算成本可能达到数百万美元。</p>
<p>大模型高昂的训练成本让普通创业公司难以为继，因此参与者基本都是的科技巨头。</p>
<h2 id="参考资料"><a class="markdownIt-Anchor" href="#参考资料"></a> 参考资料</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://openai.com/blog/chatgpt/">ChatGPT: Optimizing Language Models for Dialogue</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2203.02155">Instruct GPT: Training language models to follow instructions with human feedback</a></li>
<li><a target="_blank" rel="noopener" href="https://s3-us-west-2.amazonaws.com/openai-assets/research-covers/language-unsupervised/language_understanding_paper.pdf">GPT-1_Improving Language Understanding by Generative Pre-Training</a></li>
<li><a target="_blank" rel="noopener" href="https://d4mucfpksywv.cloudfront.net/better-language-models/language_models_are_unsupervised_multitask_learners.pdf">GPT-2_Language Models are Unsupervised Multitask Learners</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2005.14165">GPT-3_Language Models are Few-Shot Learners</a></li>
<li><a target="_blank" rel="noopener" href="https://arxiv.org/abs/2109.01652">Instruct Learning_Finetuned Language Models Are Zero-Shot Learners</a></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/machinelearning/">机器学习</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/ChatGPT/">ChatGPT</a>
                    
                      <a class="hover-with-bg" href="/tags/InstructGPT/">InstructGPT</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              

              <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5495814268572722"
                  crossorigin="anonymous"></script>
              <ins class="adsbygoogle"
                  style="display:block"
                  data-ad-client="ca-pub-4128258433761966"
                  data-ad-slot="1528926940"
                  data-ad-format="auto"
                  data-full-width-responsive="true"></ins>
              <script>
                  (adsbygoogle = window.adsbygoogle || []).push({});
              </script>

              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/10/27/multimodal-learning/">
                        <span class="hidden-mobile">多模态学习(MultiModal Learning)</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                

              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
    
  </div>
  

  
  <!-- 备案信息 -->
  <div class="beian">
    <span>
      <a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">
        陕ICP备20008129号
      </a>
    </span>
    
  </div>


  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>





  

  
    <!-- KaTeX -->
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css" />
  








  
    <!-- Baidu Analytics -->
    <script defer>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?0c64a5657309290fd8f5efe33fcbcdb4";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  
    <!-- Google Analytics -->
    <script defer>
      window.ga = window.ga || function () { (ga.q = ga.q || []).push(arguments) };
      ga.l = +new Date;
      ga('create', 'UA-166608124-1', 'auto');
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  
    <!-- Google gtag.js -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PKN25ZF7R2"></script>
    <script defer>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-PKN25ZF7R2');
    </script>
  

  

  

  





<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
